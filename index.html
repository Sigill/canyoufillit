<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>CanYouFillIt</title>
	<link rel="stylesheet" href="bootstrap.css">

	<link rel="icon" type="image/png" sizes="32x32" href="icon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="icon-16x16.png">

	<style>
body {
	background-color: black;
	color: white;
	font-family: Arial, sans-serif;
	font-size: 16px;
}
.page-header {
	padding-bottom: 9px;
	margin: 40px 0 20px;
}
.text-center {
	text-align: center;
}
.center-block {
	display: block;
	margin-right: auto;
	margin-left: auto;
}
h1 {
	font-size: 50px;
	font-weight: 500;
}
	</style>
</head>
<body>
<div class="container">
	<div class="col-xs-12 col-md-6 col-md-offset-3 text-center">
		<div class="page-header">
			<h1>CanYouFillIt</h1>
		</div>
		<p>CanYouFillIt is a Breakout-like game mixed with snooker. It is freely inspired by the game available at <a href="http://gimmefrictionbaby.com">gimmefrictionbaby.com</a>. It has been developed with HTML5 technologies, so it should work on any modern browser (including mobile ones).</p>
		<p><a class="btn btn-primary btn-lg btn-block" href="play.html" title="Play CanYouFillIt"><strong>Play now</strong></a></p>
		<p>The game has been designed to be available <strong>offline</strong>. Play once, and bookmark the page. You will then be able to play without any internet connection.</p>
		<p>If your browser is <strong>Firefox</strong> or <strong>Chrome</strong>, you can install the game as an Open Web App.</p>
		<p><button id="firefox-install-btn" class="btn btn-default btn-lg btn-block">Install in Firefox (hosted)</button></p>
		<p><button id="firefox-install-package-btn" class="btn btn-default btn-lg btn-block">Install in Firefox (packaged)</button></p>
		<p><a class="btn btn-default btn-lg btn-block" href="CanYouFillIt-ChromeHosted.crx">Install in Chrome (hosted)</a></p>
		<p><a class="btn btn-default btn-lg btn-block" href="CanYouFillIt-ChromePackaged.crx">Install in Chrome (packaged)</a></p>
		<p>You can also install it on your <strong>Android</strong> device.</p>
		<p>Or on your <strong>FirefoxOS</strong> device.</p>
	</div>
</div>
<script>
// TODO Use checkInstall to enable the install link
// https://developer.mozilla.org/fr/Apps/Quickstart/Build/Votre_premier_application

var         firefox_install_button = document.getElementById('firefox-install-btn');
    firefox_install_package_button = document.getElementById('firefox-install-package-btn');

if('mozApps' in navigator) {
	var hosted_manifest = location.href + 'manifest.webapp';
	var hostedInstallCheck = navigator.mozApps.checkInstalled(hosted_manifest);
	hostedInstallCheck.onsuccess = function() {
		if(hostedInstallCheck.result) {
			firefox_install_button.disabled = true;
		} else {
			firefox_install_button.addEventListener('click', function(evt) {
				evt.preventDefault();

				var request = navigator.mozApps.install(hosted_manifest);
				request.onsuccess = function() {};
				request.onerror = function() { alert('Installation failed: ' + this.error.name); };
			});
		};
	};

	var packaged_manifest = location.href + 'package.webapp';
	var packagedInstallCheck = navigator.mozApps.checkInstalled(packaged_manifest);
	packagedInstallCheck.onsuccess = function() {
		if(packagedInstallCheck.result) {
			firefox_install_package_button.disabled = true;
		} else {
			firefox_install_package_button.addEventListener('click', function(evt) {
				evt.preventDefault();

				var request = navigator.mozApps.installPackage(packaged_manifest);
				request.onsuccess = function() {};
				request.onerror = function() { alert('Installation failed: ' + this.error.name); };
			});
		};
	};
} else {
	firefox_install_button.style.display = 'none'
	firefox_install_package_button.style.display = 'none';
}

</script>
</body>
</html>
